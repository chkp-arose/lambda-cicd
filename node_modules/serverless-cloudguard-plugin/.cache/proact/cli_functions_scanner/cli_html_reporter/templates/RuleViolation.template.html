<div class="mt-2">{{ ' ' }}</div>
{% if feature_data and feature_data.RuleViolationInfo and feature_data.RuleViolationInfo.AwsApi%}
<div class="accordion mb-1" id="{{func}}-rule">
    <div class="text-danger mb-1">
        The following AWS API calls are not compliant with one or more custom compliance rules.
    </div>
    <ul class="list-group">
        {% for action, rules in feature_data.RuleViolationInfo.AwsApi.iteritems() %}
        {% with key = (func + "-" + action.replace(':', '-')) %}
        <li class="list-group-item align-middle bg-light  border rounded mb-1">
            <div data-toggle="collapse" data-target="#{{key}}" class="collapser-button align-middle collapser-nested">
                <i class="material-icons ml-2 mr-3 align-middle text-danger">report</i>
                {{ action }}
            </div>
            <div class="collapse mt-4 cursor-default" id="{{key}}" data-parent="#{{func}}-rule">
                {% for rule in rules %}
                <div class="card border-danger mb-1 ">
                    <div class="card-header small">
                        <b>Rule: </b> {{ rule.Name }}
                        <span class="badge badge-pill badge-dark float-right">{{ rule.Timestamp | format_datetime }}</span>
                    </div>
                    <div class="card-body text-dark-greyr">
                        <code class="text-dark">
                            {{ macros.listItem("Scope", rule.Scope) }}
                            {{ macros.listItem("ScopeData", rule.ScopeData) }}
                            {{ macros.listItem("User", rule.User) }}
                            {{ macros.listItem("Creator", rule.Creator) }}
                            {{ macros.listItem("Action", rule.Rule.Action) }}
                            {{ macros.listItem("Pattern", rule.Rule.Pattern) }}
                            {{ macros.listItem("Rule Id", rule.RuleId) }}
                        </code>
                    </div>
                </div>
                {% endfor %}
            </div>
        </li>
        {% endwith%}
        {% endfor %}
    </ul>
</div>
{% endif %}
