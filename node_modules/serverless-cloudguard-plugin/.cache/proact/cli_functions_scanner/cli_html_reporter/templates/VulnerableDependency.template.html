{% if feature_data and feature_data.Reason %}
{{ macros.message_box(feature_data.ShortReason, feature_data.Reason | wordwrap, 'sh') }}
{% endif %}

{% if feature_data and feature_data.VulnerableDepsItems %}
<div class="accordion " id="{{func}}-vul">
    <ul class="list-group">
        {% for k, dep in feature_data.VulnerableDepsItems.iteritems() %}
        {% with key = (func + k.replace('.', '-') + 'content') %}
        <li class="list-group-item align-middle">
            <div data-toggle="collapse" data-target="#{{key}}" class="collapser-button align-middle">
                <i class="material-icons ml-2 mr-3 align-middle">error_outline</i>
                {{ dep.Name }} <span class="badge badge-pill badge-secondary"> {{ dep.Version }} </span>
            </div>
            <div class="collapse mt-4" id="{{key}}" data-parent="#{{func}}-vul">
                {% for cve in dep.Vulnerabilities %}
                <div class="card border-danger mb-1 ">
                    <div class="card-header small">
                        {{ cve.get('cve-id', 'No CVE') }}
                        <span class="badge badge-pill badge-warning float-right">score: {{ cve.get('cvss-score', 'N/A') }}</span>
                    </div>
                    <div class="card-body text-dark-grey">
                        <code class="text-dark">{{ cve.description }}</code>
                    </div>
                </div>
                {% endfor %}
            </div>
        </li>
        {% endwith%}
        {% endfor %}
    </ul>
</div>
{% endif %}




